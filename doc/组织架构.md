# 组织架构
-----
## 功能描述
- 提供组织机构的查询和修改
- 组织架构变化支持订阅和发布

## 性能和扩展性要求
- 读写都复杂
- 能够扩展
- 读的频率更多

## 领域模型
- Commpany
	- id
	- name
	- departments
	- members
	  
- Department
- SubCommpany
- Employee

## 参考CQRS / EventSourcing 架构模式
CQRS的介绍网上有许多，这里采用微软MSDN上的文档：
链接如下：

[Command and Query Responsibility Segregation (CQRS) Pattern](https://msdn.microsoft.com/en-us/library/dn568103.aspx)

CQRS有好几种

![](/opt/mos/codebase/org-design/doc/cqrs3.png =700x350)
![](/opt/mos/codebase/org-design/doc/cqrs1.png =700x300)

![](/opt/mos/codebase/org-design/doc/cqrs2.png =700x400)

## 性能模型

### 写入性能分析
总得代价为校验加上事件发布的代价。
- 校验
- 事件（日志-leveldb\cassandra(LSM)）
	- DepartmentDisabled
	- DepartmentMoved
	- EmpleeJoined
	- .. 

### 读取性能评估
读取的方式有多种
- 读取部门信息
- 读取员工信息
- 查询部门员工集合
- 查询满足特定调节的岗位员工

### succinct和内存建模
树形模式的高效读取

## 读表结构
- commpany
	- id
	- name
	- parent(?)
- department
	- id
	- name 
	- parent	(?)
- employee
- user_commpany
- user_department

## 一致性分析

## 业务迁移


